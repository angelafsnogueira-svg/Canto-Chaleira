<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YouTube Playlist Visualizer</title>
<style>
  body {
    background: #111;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    padding: 20px;
    font-family: sans-serif;
  }
  .track {
    background: #222;
    color: #fff;
    width: 400px;
    border-radius: 12px;
    overflow: hidden;
    cursor: pointer;
    transition: max-height 0.3s ease;
  }
  .track-header {
    padding: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: bold;
  }
  .track-content {
    max-height: 0;
    overflow: hidden;
    padding: 0 20px;
    display: flex;
    flex-direction: column;
    gap: 15px;
  }
  .controls {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .play-btn, .loop-btn {
    background: #ff6600;
    border: none;
    color: #fff;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    font-size: 18px;
    cursor: pointer;
  }
  .loop-btn.active {
    background: #00cc66;
  }
  .waveform {
    display: flex;
    align-items: flex-end;
    gap: 2px;
    height: 60px;
  }
  .bar {
    flex: 1;
    background: linear-gradient(180deg, #ff6600, #ffcc00);
    height: 10px;
    border-radius: 2px;
    transition: height 0.1s;
  }
  .time-vol {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .volume {
    width: 120px;
  }
</style>
</head>
<body>

<h2>YouTube Playlist Visualizer</h2>

<div class="track" data-video="R96zhdIaKbc">
  <div class="track-header">"I Love You" Billie Eilish Cover</div>
  <div class="track-content">
    <div class="controls">
      <button class="play-btn">‚ñ∂</button>
      <button class="loop-btn">üîÅ</button>
    </div>
    <div class="waveform"></div>
    <div class="time-vol">
      <span class="time">0:00</span>
      <input type="range" class="volume" min="0" max="100" value="100">
    </div>
  </div>
</div>

<div class="track" data-video="OZ5eR3x9ua0">
  <div class="track-header">"Wildflower" Billie Eilish Cover</div>
  <div class="track-content">
    <div class="controls">
      <button class="play-btn">‚ñ∂</button>
      <button class="loop-btn">üîÅ</button>
    </div>
    <div class="waveform"></div>
    <div class="time-vol">
      <span class="time">0:00</span>
      <input type="range" class="volume" min="0" max="100" value="100">
    </div>
  </div>
</div>

<div class="track" data-video="w8vTw8ZTur8">
  <div class="track-header">"Those Eyes" New West Cover</div>
  <div class="track-content">
    <div class="controls">
      <button class="play-btn">‚ñ∂</button>
      <button class="loop-btn">üîÅ</button>
    </div>
    <div class="waveform"></div>
    <div class="time-vol">
      <span class="time">0:00</span>
      <input type="range" class="volume" min="0" max="100" value="100">
    </div>
  </div>
</div>

<!-- Hidden YouTube players -->
<div id="players-container"></div>

<script>
  // Load YouTube API
  let tag = document.createElement('script');
  tag.src = "https://www.youtube.com/iframe_api";
  document.body.appendChild(tag);

  const tracks = document.querySelectorAll('.track');
  const ytPlayers = [];
  const barsMap = [];
  const barsCount = 30;

  function onYouTubeIframeAPIReady() {
    tracks.forEach((track, index) => {
      const videoId = track.dataset.video;
      const container = document.createElement('div');
      container.id = `player-${index}`;
      container.style.display = 'none';
      document.getElementById('players-container').appendChild(container);

      ytPlayers[index] = new YT.Player(container.id, {
        height: '0',
        width: '0',
        videoId: videoId,
        playerVars: { autoplay: 0, controls: 0, modestbranding: 1 }
      });

      const waveformEl = track.querySelector('.waveform');
      const bars = [];
      for(let i=0;i<barsCount;i++){
        const bar = document.createElement('div');
        bar.classList.add('bar');
        waveformEl.appendChild(bar);
        bars.push(bar);
      }
      barsMap[index] = bars;

      const playBtn = track.querySelector('.play-btn');
      const loopBtn = track.querySelector('.loop-btn');
      const volumeSlider = track.querySelector('.volume');
      let isLooping = false;

      // Track expand/collapse
      track.querySelector('.track-header').addEventListener('click', ()=>{
        tracks.forEach((t,i)=>{
          if(i===index){
            t.querySelector('.track-content').style.maxHeight = '200px';
          } else {
            t.querySelector('.track-content').style.maxHeight = '0';
          }
        });
      });

      // Play/Pause button
      playBtn.addEventListener('click', ()=>{
        if(!ytPlayers[index]) return;
        ytPlayers.forEach((p,i)=>{ if(i!==index) p.pauseVideo(); });
        tracks.forEach((t,i)=>{ if(i!==index) t.querySelector('.play-btn').textContent='‚ñ∂'; });

        const state = ytPlayers[index].getPlayerState();
        if(state === YT.PlayerState.PLAYING){
          ytPlayers[index].pauseVideo();
          playBtn.textContent='‚ñ∂';
        } else {
          ytPlayers[index].unMute();
          ytPlayers[index].playVideo();
          playBtn.textContent='‚è∏';
        }
      });

      // Loop
      loopBtn.addEventListener('click', ()=>{
        isLooping=!isLooping;
        loopBtn.classList.toggle('active', isLooping);
      });

      // Volume
      volumeSlider.addEventListener('input', ()=>{
        if(ytPlayers[index]) ytPlayers[index].setVolume(volumeSlider.value);
      });

      // Animate waveform
      function animate(){
        if(ytPlayers[index] && ytPlayers[index].getDuration){
          const duration = ytPlayers[index].getDuration();
          const currentTime = ytPlayers[index].getCurrentTime();
          if(duration>0){
            let minutes=Math.floor(currentTime/60);
            let seconds=Math.floor(currentTime%60);
            if(seconds<10) seconds='0'+seconds;
            track.querySelector('.time').textContent=`${minutes}:${seconds}`;

            if(ytPlayers[index].getPlayerState()===YT.PlayerState.PLAYING){
              bars.forEach(bar=>{
                const h=Math.random()*50+10;
                bar.style.height=h+'px';
              });
            } else {
              bars.forEach(bar=>bar.style.height='10px');
            }

            if(isLooping && currentTime>=duration-0.5){
              ytPlayers[index].seekTo(0);
            }
          }
        }
        requestAnimationFrame(animate);
      }
      animate();
    });
  }
</script>

</body>
</html>
