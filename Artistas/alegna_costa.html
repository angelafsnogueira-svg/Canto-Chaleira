<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Waveform YouTube Audio Player</title>
<style>
  body {
    background: #111;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    font-family: sans-serif;
  }
  .audio-player {
    background: #222;
    padding: 20px;
    border-radius: 12px;
    width: 400px;
    color: #fff;
    display: flex;
    flex-direction: column;
    gap: 15px;
  }
  .controls {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .play-btn, .loop-btn {
    background: #ff6600;
    border: none;
    color: #fff;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    font-size: 18px;
    cursor: pointer;
  }
  .loop-btn.active {
    background: #00cc66;
  }
  .waveform {
    width: 100%;
    height: 10px;
    background: #444;
    border-radius: 5px;
    cursor: pointer;
    position: relative;
  }
  .waveform-filled {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    background: linear-gradient(90deg, #ff6600, #ffcc00);
    border-radius: 5px;
    width: 0%;
  }
  .time-vol {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .volume {
    width: 120px;
  }
</style>
</head>
<body>

<div class="audio-player">
  <div class="controls">
    <button class="play-btn">‚ñ∂</button>
    <button class="loop-btn">üîÅ</button>
  </div>
  <div class="waveform">
    <div class="waveform-filled"></div>
  </div>
  <div class="time-vol">
    <span class="time">0:00</span>
    <input type="range" class="volume" min="0" max="100" value="100">
  </div>
</div>

<div id="player"></div>

<script>
  // Load YouTube IFrame API
  let tag = document.createElement('script');
  tag.src = "https://www.youtube.com/iframe_api";
  document.body.appendChild(tag);

  let player;
  const videoId = 'R96zhdIaKbc'; // Replace with your YouTube video ID
  const playBtn = document.querySelector('.play-btn');
  const loopBtn = document.querySelector('.loop-btn');
  const waveform = document.querySelector('.waveform');
  const waveformFilled = document.querySelector('.waveform-filled');
  const time = document.querySelector('.time');
  const volumeSlider = document.querySelector('.volume');
  let isLooping = false;

  function onYouTubeIframeAPIReady() {
    player = new YT.Player('player', {
      height: '0',
      width: '0',
      videoId: videoId,
      playerVars: { autoplay: 0, controls: 0, modestbranding: 1 }
    });
  }

  // Play/Pause
  playBtn.addEventListener('click', () => {
    if(!player) return;
    const state = player.getPlayerState();
    if(state === YT.PlayerState.PLAYING) {
      player.pauseVideo();
      playBtn.textContent = '‚ñ∂';
    } else {
      player.unMute();
      player.playVideo();
      playBtn.textContent = '‚è∏';
    }
  });

  // Loop toggle
  loopBtn.addEventListener('click', () => {
    isLooping = !isLooping;
    loopBtn.classList.toggle('active', isLooping);
  });

  // Update waveform and time
  function updateWaveform() {
    if(player && player.getDuration) {
      const duration = player.getDuration();
      const currentTime = player.getCurrentTime();
      if(duration > 0) {
        const percent = (currentTime / duration) * 100;
        waveformFilled.style.width = percent + '%';

        let minutes = Math.floor(currentTime / 60);
        let seconds = Math.floor(currentTime % 60);
        if(seconds < 10) seconds = '0' + seconds;
        time.textContent = `${minutes}:${seconds}`;

        // Loop handling
        if(isLooping && currentTime >= duration - 0.5) {
          player.seekTo(0);
        }
      }
    }
    requestAnimationFrame(updateWaveform);
  }
  updateWaveform();

  // Seek on click
  waveform.addEventListener('click', (e) => {
    if(!player) return;
    const width = waveform.clientWidth;
    const clickX = e.offsetX;
    const duration = player.getDuration();
    player.seekTo((clickX / width) * duration, true);
  });

  // Volume control
  volumeSlider.addEventListener('input', () => {
    if(player) player.setVolume(volumeSlider.value);
  });
</script>

</body>
</html>
